<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>登录</title>
		<link rel="stylesheet" type="text/css" href="../../css/login.css">
		<script src="../../js/jquery1.10.2.min.js"></script>
		<script src="../../js/vue2.6.11.js"></script>
		<script src="../../js/public.js"></script>
		<script>
			!function(n){
			　　　　var e=n.document,
			　　　　t=e.documentElement,
			　　　　i=750,
			　　　　d=i/100,
			　　　　o="orientationchange"in n?"orientationchange":"resize",
			　　　　a=function(){
			　　　　　　var n=t.clientWidth||320;n>720&&(n=720);
			　　　　　　t.style.fontSize=n/d+"px"
			　　　　};
			　　　　e.addEventListener&&(n.addEventListener(o,a,!1),e.addEventListener("DOMContentLoaded",a,!1))
			　　}(window);
		</script>
	</head>
	<body>
		<div id="app">
			<div id="parent" ref="homePage" class="parent">
				<div class="login">
					<div class="login_1">
						<span>账号：</span>
						<svg t="1580475317505" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="25" height="25"><path d="M511.845 579.637c-60.191 0-116.781-23.44-159.343-66.002-42.562-42.562-66.002-99.151-66.002-159.343s23.44-116.78 66.002-159.343c42.562-42.562 99.152-66.002 159.343-66.002 60.191 0 116.781 23.44 159.343 66.002 42.562 42.562 66.002 99.151 66.002 159.343s-23.44 116.78-66.002 159.343c-42.56 42.563-99.15 66.002-159.343 66.002z m0-403.617c-98.3 0-178.273 79.972-178.273 178.273 0 98.3 79.973 178.272 178.273 178.272s178.273-79.972 178.273-178.272S610.145 176.02 511.845 176.02z" p-id="3281" fill="#1296db"></path><path d="M855.698 876.994h-47.072c0-78.935-30.74-153.144-86.554-208.96-55.815-55.813-130.024-86.553-208.959-86.553-78.933 0-153.144 30.74-208.959 86.554-55.814 55.815-86.553 130.024-86.553 208.959h-47.072c0-46.24 9.06-91.106 26.931-133.356 17.256-40.798 41.955-77.433 73.41-108.887s68.089-56.153 108.886-73.41c42.251-17.87 87.118-26.93 133.356-26.93 46.24 0 91.106 9.06 133.357 26.93 40.797 17.257 77.432 41.955 108.887 73.41s56.152 68.09 73.408 108.887c17.872 42.25 26.934 87.117 26.934 133.356z" p-id="3282" fill="#1296db"></path></svg>
						<input id="account" v-model="username" @keyup.enter="submit" type="text">
					</div>
					<div class="login_msg"></div>
					<div class="login_2">
						<span>密码：</span>
						<svg t="1580474951415" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2181" ><path d="M512 570.496a58.496 58.496 0 0 0-38.976 102.08v53.888a38.976 38.976 0 1 0 77.952 0v-53.888a58.304 58.304 0 0 0 19.456-43.584A58.368 58.368 0 0 0 512 570.496z m272.896-175.424h-38.976V297.6a233.856 233.856 0 0 0-467.712 0v97.408h-39.04c-53.824 0-97.408 43.648-97.408 97.408v370.304c0 53.824 43.648 97.408 97.408 97.408h545.728c53.76 0 97.344-43.648 97.344-97.408V492.48c0-53.824-43.584-97.408-97.344-97.408zM512 102.72a194.88 194.88 0 0 1 194.88 194.88v97.408h-389.76V297.6A194.944 194.944 0 0 1 512 102.72z m331.392 760.064c0 32.32-26.24 58.432-58.496 58.432H239.168a58.496 58.496 0 0 1-58.496-58.432V492.48c0-32.256 26.176-58.496 58.496-58.496h545.728c32.256 0 58.496 26.176 58.496 58.496v370.304z m0 0" fill="#1296db" p-id="2182"></path></svg>
						<input id="password" v-model="password" @keyup.enter="submit" type="password">
					</div>
					<div class="login_msg">{{password_msg}}</div>

					<div class="login_VCode">
						<span>验证码：</span>
						<svg t="1580475759898" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4281" width="25" height="25"><path d="M918.090878 267.682575c-36.099173-2.492774-72.380494-9.273201-103.496166-19.237133-10.075473-3.03001-20.161179-6.388501-30.306236-10.021238-21.385053-6.29845-50.481741-18.791995-83.506902-36.592406-0.354064-0.161682-0.704035-0.364297-1.052982-0.552585-7.763824-4.190439-15.706727-8.66331-23.793916-13.412474-10.898211-6.243191-21.689998-12.902868-32.462343-19.84293-0.417509-0.281409-0.829901-0.533143-1.237177-0.806365-7.738241-4.997827-15.443737-10.158361-23.092951-15.518438-4.976338-3.413749-9.959839-7.051603-14.945387-10.659781-3.748371-2.7486-7.496741-5.330402-11.248182-8.16496-27.427676-20.48659-54.499242-43.471071-79.849606-68.233034-25.350364 24.761963-52.426023 47.746444-79.853699 68.233034-3.744277 2.833535-7.498788 5.41636-11.246135 8.16496-4.991688 3.608178-9.970072 7.246031-14.945387 10.659781-7.652284 5.360078-15.356756 10.520611-23.094998 15.518438-0.405229 0.273223-0.824785 0.524956-1.232061 0.806365-10.780531 6.941086-21.564132 13.599739-32.464389 19.84293-8.090259 4.748141-16.030092 9.222035-23.798009 13.412474-0.345877 0.187265-0.704035 0.38988-1.046842 0.552585-33.025161 17.800411-62.127989 30.292933-83.515089 36.592406-10.138918 3.637854-20.216437 6.992251-30.302143 10.021238-31.118741 9.963932-67.390853 16.744359-103.496166 19.237133l-0.086981 0c1.052982 16.181541 2.13871 37.645388 3.403516 60.882626 0.200568 0 0.434905 0 0.669242-0.035816 6.091742 86.72827 23.472598 210.093972 49.694819 282.57782 1.174756 3.166109 2.172479 6.471388 3.347235 9.605775 0.550539 1.473561 1.196245 2.837628 1.750877 4.303003 62.763462 162.03849 171.776272 279.94076 302.786071 323.156004l0 0.450255c17.316387 5.716188 31.905664 9.249665 43.426045 11.467169 11.518335-2.223644 26.115797-5.750981 43.432185-11.467169l0-0.450255c131.011846-43.215244 240.017492-161.117514 302.788118-323.156004 0.554632-1.475608 1.198292-2.829442 1.757017-4.303003 1.166569-3.134387 2.168386-6.439666 3.339048-9.605775 26.227338-72.484871 43.60717-195.84955 49.700959-282.57782 0.236384 0.033769 0.473791 0.033769 0.669242 0.033769 1.26276-23.235191 2.343371-44.696991 3.3984-60.880579L918.090878 267.682575zM870.734314 309.574684l-0.509606 9.497305c-0.51984 2.166339-0.86367 4.379751-1.02126 6.622838-5.674233 80.730673-21.61018 200.398146-47.276746 271.336802-0.710175 1.920746-1.375324 3.885494-2.034333 5.847172-0.411369 1.221828-0.816598 2.449795-1.445932 4.049223-0.524956 1.232061-1.036609 2.467191-1.38351 3.396353C758.704798 760.970398 658.351206 869.434715 541.728068 907.903865c-1.886977 0.620124-3.708462 1.359974-5.458315 2.200108-7.915273 2.473331-15.665795 4.582365-23.177885 6.302543-7.460925-1.709945-15.179724-3.810792-23.077601-6.272867-1.77646-0.855484-3.626597-1.599428-5.544273-2.230808C367.840716 869.434715 267.48917 760.970398 209.243605 610.599645c-0.458441-1.206478-0.940418-2.37714-1.692548-4.14746-0.443092-1.178849-0.840134-2.394537-1.251503-3.610224-0.663102-1.963725-1.332345-3.931542-1.934049-5.560646-25.759687-71.198575-41.694611-190.869119-47.364751-271.582395-0.157589-2.251274-0.50142-4.473895-1.027399-6.644327l-0.497327-9.296737c-0.078795-1.493004-0.157589-2.974751-0.236384-4.446265 24.62177-3.805676 48.370661-9.30083 69.956282-16.21838 10.130731-3.045359 20.419052-6.435573 31.414477-10.353812 25.206078-7.576559 56.437383-21.220301 90.478687-39.532365 0.590448-0.302899 1.155313-0.603751 1.654686-0.877997 8.228405-4.439102 16.647145-9.182127 24.809035-13.975293 10.709923-6.132674 21.985734-13.023618 34.475186-21.064758 0.349971-0.224104 0.952698-0.611937 1.296529-0.846274 8.204869-5.300726 16.375969-10.776438 24.12035-16.205077 4.546549-3.114944 9.094122-6.402827 13.650905-9.699919l2.443655-1.769296 4.041036-2.912329c2.581802-1.847068 5.16258-3.699252 7.535627-5.495154 17.894555-13.369495 35.278481-27.453259 51.984978-42.119283 16.687054 14.650675 34.022884 28.704762 51.797713 41.980113 2.565429 1.936095 5.127787 3.776 7.691169 5.609765l4.27742 3.085268 1.552356 1.125637c4.77884 3.462868 9.56075 6.92369 13.94971 9.928117 8.117888 5.693676 16.301268 11.17348 23.730471 15.962553l2.059915 1.345648c12.386098 7.980765 23.663956 14.874779 34.072003 20.836561 8.576329 5.03262 16.994046 9.774621 25.015743 14.103206 0.399089 0.217964 0.950651 0.50756 1.534959 0.808412 34.167171 18.404162 65.523319 32.114418 90.813309 39.71963 11.014868 3.921309 21.271466 7.30129 30.587646 10.091846 22.11774 7.083326 46.068222 12.641925 70.781066 16.470113C870.888833 306.717613 870.812085 308.142056 870.734314 309.574684zM711.261253 411.655617 476.928227 651.831722 356.968088 528.867156c-8.311293-8.515954-21.772886-8.515954-30.084179 0-8.311293 8.523117-8.311293 22.320355 0 30.839379l135.00274 138.378627c4.155646 4.260024 9.597589 6.390547 15.041578 6.390547 5.443989 0 10.886955-2.130524 15.040555-6.390547l249.374604-255.592212c8.311293-8.515954 8.311293-22.316262 0-30.837332C733.034139 403.137617 719.571523 403.137617 711.261253 411.655617z" p-id="4282" fill="#1296db"></path></svg>
						<input v-model="VCode_num" @keyup.enter="submit" type="text">
					</div>
					<div class="login_msg">{{VCode_msg}}</div>
					<div class="login_3" @click="VCode">
						<div v-html="VCode_img"></div>
					</div>
					<div @click="submit()" class="login_4">
						登陆
					</div>
					<a href="../register/register.html" class="go_register">没有账号？去注册</a>
				</div>
			</div>
		</div>
		<script src="../../js/md5.js"></script>
		<script>
			new Vue({
				el: '#app',
				data: {
					username: "",
					username_msg: "",
					password: "",
					password_msg: "",
					VCode_img: "",
					VCode_num: "",
					VCode_msg: "",
					clientHeight: "",

				},
				methods: {
					VCode() {
						$.ajax({
							url: topurl + "/user/VCode",
							type: 'POST',
							async: true,
							xhrFields: {
								withCredentials: true
							},
							data: {},
							success: (data)=> {
								this.VCode_img = data.codeData.img
							},
							error: ()=> {
								alert('服务器发生错误！');
							}
						});
					},
					submit() {
						if(this.username ==="" || this.password===""){
							this.password_msg="账号或密码不能为空！";
							return false;
						}else if(this.VCode_num===""){
							this.password_msg="";
							this.VCode_msg="验证码不能为空！";
							return false;
						}
						this.password_msg="";
						this.VCode_msg="";
						$.ajax({
							url: topurl + "/user/login",
							type: 'POST',
							async: true,
							xhrFields: {
								withCredentials: true
							},
							data: {
								email: this.username,
								password: hex_md5(this.password),
								VCode: this.VCode_num
							},
							success: (res)=> {
                                console.log(res)
								if(res.code!=0){
									alert(res.message)
									this.VCode_msg="";
									this.password_msg=data.message;
									return
								}else if(res.code==0){
									localStorage.setItem("login_msg", JSON.stringify(res));
									window.open("../app/app.html",'_self')
								}
								
							},
							error: function() {
								alert('服务器发生错误！');
							}
						});

					}

				},
				mounted() {
					this.VCode();
					this.clientHeight = window.innerHeight;
					//console.log(window.innerHeight);
					this.$refs.homePage.style.height = this.clientHeight + "px";

				}
			})
		</script>
	</body>
</html>
