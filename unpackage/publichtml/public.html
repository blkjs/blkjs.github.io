<!DOCTYPE html>
<html lang="zh-cn">
 
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
        <title>板栗壳技术有限公司</title>
		<link rel="stylesheet" type="text/css" href="../../css/register.css">
		<link rel="stylesheet" type="text/css" href="../../css/public.css">
		<script src="../../js/jquery1.10.2.min.js"></script>
		<script src="../../js/public.js"></script>
		<style>
			.message{
				background-color: #5CB85C ;
			}
		</style>
    </head>
    <body>
			<div class="app-top-2">
				<div class="app-top-3">
					<div class="app-top-5" onclick="app(1)">主页</div>
					<div class="app-top-5" onclick="app(2)">服务介绍</div>
					<div class="app-top-5" onclick="app(3)">项目案例</div>
					<div class="app-top-5" onclick="app(4)">关于我们</div>
					<div class="app-top-5" onclick="app(5)">帮助中心</div>
				</div>
				<div class="app-top-4">
					<div class="app-top-5" id="login" onclick="login()">登录</div>
					<div class="app-top-5" id="register" onclick="register()">注册</div>
				</div>
			</div>
			<div class="app-content">
				<div class="app-content-top">
					<div class="app-content-top-1">
						<img src="../../img/logo.png" />
					</div>
					<div class="app-content-top-2">
						<div class="content-right">
							<div class="content-right-top">公共页面<span></span></div>
						</div>
						<div class="content-left">
							<div class="show" >
							</div>
							<input type="text" class="text" />
							<input type="button" onclick="sub()" value="发送" />
						</div>
					</div>
				</div>
				<div class="app-content-1">
					<div class="app-content-3" onclick="leavemsg()"><img class="icon-img" src="../../img/留言.png"> 留言</div>
					<div class="app-content-2" onclick="open_qq()">
						<a href="tencent://message/?uin=201747831&Site=Sambow&Menu=yes">
							<img class="icon-img" src="../../img/QQ.png">
						</a>
						联系
					</div>
					<div class="app-content-2" id="service"><img class="icon-img" src="../../img/二维码.png">客服</div>
					<div class="app-content-4" onclick="to_top()"><img class="icon-img" src="../../img/返回顶部.png">顶部</div>
				</div>
				<div class="WeChat" id="WeChat">
					<img src="../../img/kefu.png" class="WeChat_img" >
				</div>
			</div>
			<div class="footer">
				<div class="footer_parent">
					<div class="footer_1">
						<img src="../../img/kefu.png" class="WeChat_img" >
						<span>打开微信扫一扫</span>
					</div>
					<div class="footer_1">
						<div class="footer_1_1">
							<h5>团队信息</h5>
							<p onclick="app(4)">关于我们</p>
							<p onclick="app(3)">查看案例</p>
							<p onclick="app(2)">服务介绍</p>
						</div>
					</div>
					<div class="footer_1">
						<div class="footer_1_1">
							<h5>商务合作</h5>
							<p>开发合作</p>
							<p>广告合作</p>
							<p>其他</p>
						</div>
					</div>
					<div class="footer_1">
						<div class="footer_1_1">
							<h5 onclick="app(5)">帮助中心</h5>
							<p>忘记密码</p>
							<p onclick="register()">免费注册</p>
							<p onclick="leavemsg()">在线留言</p>
						</div>
					</div>
				</div>
				<div class="footer_parent_1">
					板栗壳技术有限公司 版权所有 粤ICP备17108118号
				</div>
				
			</div>
			

		
		<script src="http://pv.sohu.com/cityjson?ie=utf-8"></script>
        <script>
			
			function randomWord(randomFlag, min, max){
						var str = "",
							range = min,
							arr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];
							// 随机产生
							if(randomFlag){
								range = Math.round(Math.random() * (max-min)) + min;
							}
							for(var i=0; i<range; i++){
								pos = Math.round(Math.random() * (arr.length-1));
								str += arr[pos];
							}
							return str;
				}
						
	var sub=(event)=>{
				//localStorage.removeItem('random')
				if(!localStorage.getItem('random')){
					random =randomWord(1,12,12);//随机一个id
					localStorage.setItem("random",random)
				}
				console.log(localStorage.getItem('random'))
		
				let message = $(".text")[0].value//输入消息
				let ws = new WebSocket("ws://localhost:3001");
				ws.onopen = function() {
					//console.log(returnCitySN["cip"]+','+returnCitySN["cname"])  
				  ws.send(JSON.stringify({//发送消息
					  "message":message,
					  ip:returnCitySN["cip"],
					  id:localStorage.getItem('random')
				  }));
				};
				ws.onmessage = function(data) {//接收消息
				let msg = "<div class='message'>"+JSON.parse(data.data).message  +"</div>" 
				  $(".show").append(msg );
				  console.log(data.data)
				  /* setTimeout(() => {
				    ws.close();
				  }, 5000); */
				};
				ws.onclose = function(params) {
				  console.log("client：关闭连接");
				};
		return
		
		
		$.ajax({
			//url: "http://49.235.80.50:3001/user/VCode",
			url: "http://localhost:3000/notice/WebSocket",
			type: 'POST',
			async: true,
			xhrFields: {
				withCredentials: true
			},
			data: {
				userEmail: "1051011877@qq.com",
				
			},
			success: (data)=> {
				console.log(data);
				
				
				
			},
			error: function() {
				console.log('服务器发生错误！');
			}
		});
		
		
		/* if(data.status==1){//验证码
			$('.img > svg').remove();
			$(".img").append(data.codeData.img);
		} */
		
		//console.log(d.target.files[0]);//图片上传
		/* file = event.target.files[0];
		  var a = new FileReader();
		   a.onload = (e) =>{
		      var base64Str = e.target.result;//获取base64
		       //console.log(base64Str);
			  
		    }
		   a.readAsDataURL(file); */
		
	}
        </script>
    </body>
</html>



